<div class="register w-full">
    <mat-card
        appearance="outlined"
        class="register-card mat-elevation-z4 m-auto"
    >
        <mat-card-header>
            <mat-card-title class="text-center">
                Hoteler 系统注册
            </mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <form
                class="form-field-full"
                [formGroup]="form"
                (submit)="register()"
            >
                <mat-form-field appearance="outline">
                    <mat-label>用户名</mat-label>
                    <input
                        matInput
                        placeholder="用户名"
                        formControlName="username"
                    />
                    @if (username.invalid) {
                        <mat-error>请输入用户名</mat-error>
                    }
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-label>密码</mat-label>
                    <input
                        matInput
                        placeholder="密码"
                        [type]="togglePassword.type"
                        formControlName="password"
                    />
                    <matx-pass-toggle-visibility #togglePassword matSuffix />
                    @if (password.invalid) {
                        <mat-error>请输入密码</mat-error>
                    }
                </mat-form-field>
                <mat-form-field appearance="outline">
                    <mat-label>确认密码</mat-label>
                    <input
                        matInput
                        placeholder="密码"
                        [type]="hideConfirmPassword ? 'password' : 'text'"
                        formControlName="confirmPassword"
                    />
                    <button
                        mat-icon-button
                        matSuffix
                        [attr.aria-label]="'Hide confirm password'"
                        (click)="toggleVisibilityConfirmPasswordIcon($event)"
                    >
                        <mat-icon>{{
                            hideConfirmPassword
                                ? 'visibility_off'
                                : 'visibility'
                        }}</mat-icon>
                    </button>
                    @if (confirmPassword.invalid) {
                        <mat-error> 请再次输入密码 </mat-error>
                    }
                </mat-form-field>
                @if (
                    password.valid &&
                    confirmPassword.valid &&
                    form.errors?.identityPassword
                ) {
                    <mat-error>两次密码不一致</mat-error>
                }
                <button
                    #btn
                    class="w-full"
                    mat-flat-button
                    color="primary"
                    [disabled]="form.invalid"
                    [loading]="isLoading"
                >
                    注册
                </button>
            </form>
        </mat-card-content>
        <mat-card-actions>
            <div class="flex justify-start w-full px-2 gap-2">
                <span
                    class="has-account inline-flex items-center justify-center"
                >
                    已经有账号了?</span
                >
                <a mat-button routerLink="/login">登录</a>
            </div>
        </mat-card-actions>
    </mat-card>
</div>
